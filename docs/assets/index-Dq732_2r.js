(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const A="#d4a5a5",U=new Date,z=`${U.getFullYear()}. ${U.getMonth()+1}. ${U.getDate()}.`;let f=JSON.parse(localStorage.getItem("inspy_memos"))||[],v=JSON.parse(localStorage.getItem("inspy_folders"))||["ì•„ì´ë””ì–´","ì¼ìƒ"],I=localStorage.getItem("inspy_pw")||null,x=[],L="ì „ì²´",q=!1,b="",K={w:0,h:0,kb:0},R=new Date,u={start:z,end:z},E="idle",w=null,D=!1;function te(){const e=localStorage.getItem("inspy_theme"),t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,n=e?e==="dark":t;document.body.classList.toggle("dark-mode",n),document.getElementById("themeBtn").innerText=n?"â˜€ï¸":"ğŸŒ™",document.getElementById("mainLogo").src=n?"logo_d.png":"logo_l.png"}function $(e){const t=(e||"").match(/^(\d{4})\.\s*(\d{1,2})\.\s*(\d{1,2})\.$/);return t?new Date(Number(t[1]),Number(t[2])-1,Number(t[3]),12,0,0,0):null}function F(e,t){const n=$(e),a=$(t);return!n||!a?null:n.getTime()<=a.getTime()?{start:e,end:t}:{start:t,end:e}}function G(e,t){if(!t)return!0;const n=$(e),a=$(t.start),o=$(t.end);if(!n||!a||!o)return!1;const i=n.getTime();return i>=a.getTime()&&i<=o.getTime()}function Y(e){const t=$(e);if(!t)return"";const n=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${n}.${a}.${o}`}function ne(e){const t=e.replace("#","").trim();return t.length!==6?null:{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16)}}function N(e){const t=ne(e);if(!t)return;const n=document.documentElement.style;n.setProperty("--primary",e),n.setProperty("--p-r",t.r),n.setProperty("--p-g",t.g),n.setProperty("--p-b",t.b),localStorage.setItem("inspy_primary",e),ie(e),p()}function oe(){const e=localStorage.getItem("inspy_primary");e&&/^#[0-9A-Fa-f]{6}$/.test(e)?N(e):N(A)}function ae(){localStorage.removeItem("inspy_primary"),N(A),d("ê¸°ë³¸ ìƒ‰ìƒìœ¼ë¡œ ë³€ê²½")}function ie(e){const t=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="85" fill="${e}">âœ´ï¸</text></svg>`,n="data:image/svg+xml,"+encodeURIComponent(t),a=document.getElementById("appFavicon");a&&a.setAttribute("href",n)}function X(){const t=new Date().toLocaleTimeString("ko-KR",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});document.getElementById("liveClock").innerText=t}setInterval(X,1e3);X();let V=null;function d(e,t="",n=1600){const a=document.getElementById("toastWrap");if(!a)return;V&&clearTimeout(V),[...a.children].forEach(i=>{i.classList.add("fadeout"),setTimeout(()=>i.remove(),230)});const o=document.createElement("div");o.className="toast",o.innerHTML=`<div>${e}</div>${t?`<div class="subline">${t}</div>`:""}`,a.appendChild(o),V=setTimeout(()=>{o.classList.add("fadeout"),setTimeout(()=>o.remove(),230)},n)}function re(e,t,n=10,a=120){const o=getComputedStyle(document.documentElement).getPropertyValue("--primary").trim()||A;for(let i=0;i<n;i++){const s=document.createElement("div");s.className="spark",s.textContent="âœ´ï¸",s.style.left=`${e}px`,s.style.top=`${t}px`;const r=(Math.random()*a-a/2).toFixed(0)+"px",y=(Math.random()*-a-30).toFixed(0)+"px";s.style.setProperty("--dx",r),s.style.setProperty("--dy",y),s.style.fontSize=(12+Math.random()*9).toFixed(0)+"px",s.style.color=o,document.body.appendChild(s),setTimeout(()=>s.remove(),700)}}function le(e,t=10){if(!e)return;const n=e.getBoundingClientRect();re(n.left+n.width*.7,n.top+n.height*.2,t,120)}function J(e){const t=document.getElementById("imgViewer"),n=document.getElementById("viewerImg");!t||!n||(n.src=e,t.classList.add("open"))}function se(){const e=document.getElementById("imgViewer"),t=document.getElementById("viewerImg");t&&(t.src=""),e&&e.classList.remove("open")}function ce(){const e={memos:f,folders:v,lockPw:I,primary:localStorage.getItem("inspy_primary")||null,theme:localStorage.getItem("inspy_theme")||null},t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download=`inspyfold_backup_${new Date().toLocaleDateString()}.json`,a.click(),d("ë‚´ë³´ë‚´ê¸° ì¤€ë¹„ ì™„ë£Œ","ë°±ì—… íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë¼ìš”")}function de(e){const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=a=>{try{const o=JSON.parse(a.target.result);f=o.memos||[],v=o.folders||["ì•„ì´ë””ì–´","ì¼ìƒ"],I=o.lockPw||null,o.primary&&/^#[0-9A-Fa-f]{6}$/.test(o.primary)&&localStorage.setItem("inspy_primary",o.primary),(o.theme==="dark"||o.theme==="light")&&localStorage.setItem("inspy_theme",o.theme),I?localStorage.setItem("inspy_pw",I):localStorage.removeItem("inspy_pw"),C(!1),d("ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ","ìƒˆ ë°ì´í„°ë¡œ ê°±ì‹ ëì–´ìš”"),location.reload()}catch{d("ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨","íŒŒì¼ í˜•ì‹ì„ í™•ì¸í•´ìš”")}},n.readAsText(t)}const S={open:!1,onSubmit:null};function me(e){g()}function T(e){S.open=!0,S.onSubmit=e.onSubmit||null;const t=document.getElementById("modalBackdrop"),n=document.getElementById("modalTitle"),a=document.getElementById("modalDesc"),o=document.getElementById("modalHint"),i=document.getElementById("modalInput"),s=document.getElementById("modalActions"),r=document.getElementById("modalExtra");n.innerText=e.title||"",a.innerText=e.desc||"",o.innerText=e.hint||"",r.innerHTML=e.extraHTML||"",e.showInput?(i.style.display="block",i.type=e.inputType||"text",i.value=e.inputValue||"",i.placeholder=e.inputPlaceholder||"",i.maxLength=e.inputMax||64,setTimeout(()=>i.focus(),0)):(i.style.display="none",i.value=""),s.innerHTML="",(e.actions||[]).forEach(y=>{const l=document.createElement("button");l.className=`btn-modal ${y.variant||""}`.trim(),l.innerText=y.label,l.onclick=y.onClick,s.appendChild(l)}),i.onkeydown=y=>{y.key==="Enter"&&S.onSubmit&&(y.preventDefault(),S.onSubmit())},t.classList.remove("hidden")}function g(){S.open=!1,S.onSubmit=null,document.getElementById("modalBackdrop").classList.add("hidden"),document.getElementById("modalExtra").innerHTML=""}function O(){return document.getElementById("modalInput").value||""}function M(e){document.getElementById("modalHint").innerText=e||""}function ue(){const e=["#d4a5a5","#f3a6b8","#ffb86b","#facc15","#34d399","#22c55e","#2dd4bf","#38bdf8","#3b82f6","#8b5cf6","#a78bfa","#f472b6"],t=localStorage.getItem("inspy_primary")||A,n=e.map(a=>`<div class="color-dot ${a.toLowerCase()===t.toLowerCase()?"active":""}" style="background:${a}" onclick="setPrimary('${a}')"></div>`).join("");T({title:"í…Œë§ˆ ìƒ‰ìƒ",desc:"ì•±ì˜ í¬ì¸íŠ¸ ì»¬ëŸ¬ë¥¼ ë°”ê¿”ìš”.",hint:"ì›í•˜ëŠ” ìƒ‰ì„ ì„ íƒí•œ ë’¤ ë‹«ì•„ë„ ìë™ ì €ì¥ë¼ìš”.",showInput:!1,extraHTML:`<div class="palette-grid">${n}</div>`,actions:[{label:"ê¸°ë³¸ê°’",onClick:()=>ae()},{label:"ì™„ë£Œ",variant:"primary",onClick:()=>{d("í…Œë§ˆ ì ìš© ì™„ë£Œ"),g()}}]})}const pe=/^[A-Za-z0-9]+$/;function ge(){if(!I){T({title:"ì ê¸ˆ ì„¤ì •",desc:"ì´ ì•±ì„ ì ê¸€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•´ìš”.",hint:"ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸/ìˆ«ìë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.",showInput:!0,inputType:"password",inputPlaceholder:"ì˜ë¬¸/ìˆ«ì ë¹„ë°€ë²ˆí˜¸",inputMax:32,actions:[{label:"ì·¨ì†Œ",onClick:()=>g()},{label:"ì ê·¸ê¸°",variant:"primary",onClick:()=>{const e=O().trim();if(!e){M("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ìš”.");return}if(!pe.test(e)){M("ì˜ë¬¸/ìˆ«ìë§Œ ì…ë ¥í•  ìˆ˜ ìˆì–´ìš”.");return}I=e,localStorage.setItem("inspy_pw",e),x=[],g(),setTimeout(()=>d("ì ê¸ˆì´ ì„¤ì •ëì–´ìš”","ë©”ëª¨ëŠ” íƒ­í•˜ì—¬ ì¼ì‹œí•´ì œ ê°€ëŠ¥í•´ìš”"),60),p()}}]});return}T({title:"ì ê¸ˆ ë„ê¸°",desc:"ì ê¸ˆì„ ë„ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ìš”.",hint:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ìƒì–´ë²„ë ¸ë‹¤ë©´ ì´ˆê¸°í™”ê°€ í•„ìš”í•´ìš”.",showInput:!0,inputType:"password",inputPlaceholder:"ë¹„ë°€ë²ˆí˜¸ ì…ë ¥",inputMax:32,actions:[{label:"ì·¨ì†Œ",onClick:()=>g()},{label:"ì´ˆê¸°í™”",variant:"danger",onClick:()=>fe()},{label:"ì ê¸ˆ ë„ê¸°",variant:"primary",onClick:()=>{if(O()!==I){M("ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•Šì•„ìš”."),d("ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•Šì•„ìš”");return}I=null,localStorage.removeItem("inspy_pw"),x=[],g(),setTimeout(()=>d("ì ê¸ˆì„ ê»ì–´ìš”"),60),p()}}]})}function fe(){T({title:"ì´ˆê¸°í™” ì•ˆë‚´",desc:`ë¹„ë°€ë²ˆí˜¸ë¥¼ ìƒì–´ë²„ë ¸ë‹¤ë©´ ì´ˆê¸°í™”ë§Œ ê°€ëŠ¥í•´ìš”.
ì´ˆê¸°í™”í•˜ë©´ ì ê¸ˆì´ í’€ë¦¬ë©´ì„œ, ëª¨ë“  ê¸°ë¡ì´ ì‚­ì œë¼ìš”.`,hint:"ë‹¤ìŒ ë‹¨ê³„ì—ì„œ í•œ ë²ˆ ë” í™•ì¸í•´ìš”.",showInput:!1,actions:[{label:"ì·¨ì†Œ",onClick:()=>g()},{label:"ë‹¤ìŒ",variant:"danger",onClick:()=>ye()}]})}function ye(){T({title:"ì •ë§ ì´ˆê¸°í™”í• ê¹Œìš”?",desc:`ì´ˆê¸°í™”ë¥¼ ì§„í–‰í•˜ë©´ ì§€ê¸ˆê¹Œì§€ì˜ ëª¨ë“  ê¸°ë¡ì´ ì‚­ì œë¼ìš”.
ë˜ëŒë¦´ ìˆ˜ ì—†ì–´ìš”.`,hint:"ì‚­ì œë¥¼ ì›í•˜ë©´ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ìš”.",showInput:!1,actions:[{label:"ì·¨ì†Œ",onClick:()=>g()},{label:"ëª¨ë“  ê¸°ë¡ ì‚­ì œ",variant:"danger",onClick:()=>{localStorage.removeItem("inspy_memos"),localStorage.removeItem("inspy_folders"),localStorage.removeItem("inspy_pw"),f=[],v=["ì•„ì´ë””ì–´","ì¼ìƒ"],I=null,x=[],g(),setTimeout(()=>d("ì´ˆê¸°í™” ì™„ë£Œ","ëª¨ë“  ê¸°ë¡ì´ ì‚­ì œëì–´ìš”"),60),location.reload()}}]})}function he(e){T({title:"ì¼ì‹œ í•´ì œ",desc:"ì´ ë©”ëª¨ë¥¼ ì¼ì‹œì ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆì–´ìš”.",hint:"ì ê¸ˆì„ ì™„ì „íˆ ë„ë ¤ë©´ í—¤ë”ì˜ ìë¬¼ì‡  ì•„ì´ì½˜ì„ ëˆŒëŸ¬ìš”.",showInput:!0,inputType:"password",inputPlaceholder:"ë¹„ë°€ë²ˆí˜¸ ì…ë ¥",inputMax:32,actions:[{label:"ì·¨ì†Œ",onClick:()=>g()},{label:"ì¼ì‹œ í•´ì œ",variant:"primary",onClick:()=>{if(O()!==I){M("ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•Šì•„ìš”."),d("ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•Šì•„ìš”");return}x.includes(e)||x.push(e),g(),setTimeout(()=>d("ì¼ì‹œí•´ì œ ì™„ë£Œ","ì™„ì „ í•´ì œëŠ” í—¤ë” ìë¬¼ì‡ ì—ì„œ ê°€ëŠ¥í•´ìš”"),60),p()}}]})}function ve(){const e=document.getElementById("searchWrap");e.classList.toggle("open"),e.classList.contains("open")&&document.getElementById("searchInput").focus(),W()}function Ie(){W(),p()}function W(){const e=(document.getElementById("searchInput").value||"").trim();document.getElementById("searchClearBtn").classList.toggle("show",e.length>0)}function we(){const e=document.getElementById("searchInput");e.value="",W(),d("ê²€ìƒ‰ì–´ ì‚­ì œë¨"),p(),e.focus()}function C(e=!0){localStorage.setItem("inspy_memos",JSON.stringify(f)),localStorage.setItem("inspy_folders",JSON.stringify(v)),e&&p()}function Ee(){T({title:"ìƒˆ í´ë” ë§Œë“¤ê¸°",desc:"í´ë” ì´ë¦„ì„ ì…ë ¥í•´ìš”.",hint:"ì¤‘ë³µ ì´ë¦„ì€ ë§Œë“¤ ìˆ˜ ì—†ì–´ìš”.",showInput:!0,inputType:"text",inputPlaceholder:"ì˜ˆ: ì•„ì´ë””ì–´",inputMax:18,actions:[{label:"ì·¨ì†Œ",onClick:()=>g()},{label:"ìƒì„±",variant:"primary",onClick:()=>{const e=O().trim();if(!e){M("í´ë” ì´ë¦„ì„ ì…ë ¥í•´ìš”.");return}if(v.includes(e)){M("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” í´ë”ì˜ˆìš”.");return}v.push(e),g(),setTimeout(()=>d("í´ë” ìƒì„±ë¨",e),60),C()}}]})}function be(e,t){if(t.stopPropagation(),v.length<=1){d("í´ë”ëŠ” ìµœì†Œ 1ê°œê°€ í•„ìš”í•´ìš”");return}T({title:"í´ë” ì‚­ì œ",desc:`'${e}' í´ë”ë¥¼ ì‚­ì œí• ê¹Œìš”?`,hint:"í•´ë‹¹ í´ë”ì˜ ë©”ëª¨ëŠ” ë‹¤ë¥¸ í´ë”ë¡œ ì´ë™ë¼ìš”.",showInput:!1,actions:[{label:"ì·¨ì†Œ",onClick:()=>g()},{label:"ì‚­ì œ",variant:"danger",onClick:()=>{v=v.filter(n=>n!==e),f=f.map(n=>n.tags[0]===e?{...n,tags:[v[0]]}:n),L===e&&(L="ì „ì²´"),g(),setTimeout(()=>d("í´ë” ì‚­ì œë¨",`'${e}'`),60),C()}}]})}function Te(e){L=e,p()}function ke(e){T({title:"ë©”ëª¨ ì‚­ì œ",desc:"ì´ ë©”ëª¨ë¥¼ ì‚­ì œí• ê¹Œìš”?",hint:"ë˜ëŒë¦´ ìˆ˜ ì—†ì–´ìš”.",showInput:!1,actions:[{label:"ì·¨ì†Œ",onClick:()=>g()},{label:"ì‚­ì œ",variant:"danger",onClick:()=>{g(),Le(e)}}]})}function Le(e){const t=document.querySelector(`.memo-item[data-id="${e}"]`);t&&t.classList.add("removing"),setTimeout(()=>{f=f.filter(n=>n.id!==e),x=x.filter(n=>n!==e),d("ì‚­ì œ ì™„ë£Œ"),C()},360)}function xe(e,t){f=f.map(n=>n.id===e?{...n,fav:!n.fav}:n),t&&(t.classList.remove("popped"),t.offsetWidth,t.classList.add("popped")),localStorage.setItem("inspy_memos",JSON.stringify(f)),setTimeout(()=>p(),120)}function Be(e,t){f=f.map(n=>n.id===e?{...n,tags:[t]}:n),C()}function j(e=!0){b="",K={w:0,h:0,kb:0};const t=document.getElementById("imgInput");t&&(t.value="");const n=document.getElementById("imgPreviewWrap"),a=document.getElementById("imgPreview");n&&(n.style.display="none"),a&&(a.src=""),e||d("ì²¨ë¶€ í•´ì œë¨")}async function Se(e,t={}){const n=t.maxW??1440,a=t.maxH??1440,o=t.quality??.82,i=new Image,s=URL.createObjectURL(e);await new Promise((H,ee)=>{i.onload=()=>H(),i.onerror=()=>ee(new Error("ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨")),i.src=s});const r=i.naturalWidth||i.width,y=i.naturalHeight||i.height,l=Math.min(n/r,a/y,1),m=Math.max(1,Math.round(r*l)),c=Math.max(1,Math.round(y*l)),B=document.createElement("canvas");B.width=m,B.height=c;const h=B.getContext("2d",{alpha:!1});h.fillStyle="#ffffff",h.fillRect(0,0,m,c),h.imageSmoothingEnabled=!0,h.imageSmoothingQuality="high",h.drawImage(i,0,0,m,c);const k=B.toDataURL("image/jpeg",o);URL.revokeObjectURL(s);const _=Math.round(k.length*3/4/1024);return{dataUrl:k,w:m,h:c,kb:_}}let P=null;function $e(){const e=document.getElementById("imgPreview");e&&(e.onclick=()=>{b&&J(b)},e.onpointerdown=()=>{b&&(clearTimeout(P),P=setTimeout(()=>J(b),320))},e.onpointerup=()=>clearTimeout(P),e.onpointercancel=()=>clearTimeout(P),e.onpointerleave=()=>clearTimeout(P))}async function Me(e){const t=e.target.files&&e.target.files[0];if(t){if(!t.type.startsWith("image/")){d("ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì²¨ë¶€í•  ìˆ˜ ìˆì–´ìš”");return}d("ì²˜ë¦¬ ì¤‘...","ë¦¬ì‚¬ì´ì¦ˆ/ì••ì¶•í•˜ê³  ìˆì–´ìš”",900);try{const{dataUrl:n,w:a,h:o,kb:i}=await Se(t,{maxW:1440,maxH:1440,quality:.82});b=n,K={w:a,h:o,kb:i};const s=document.getElementById("imgPreviewWrap"),r=document.getElementById("imgPreview");r&&(r.src=b),s&&(s.style.display="block"),$e(),d("ì´ë¯¸ì§€ ì²¨ë¶€ë¨",`${a}Ã—${o}px Â· ì•½ ${i}KB`)}catch{d("ì´ë¯¸ì§€ ì²˜ë¦¬ ì‹¤íŒ¨","ë‹¤ì‹œ ì‹œë„í•´ìš”"),j(!0)}}}function Ce(){const e=document.getElementById("memoInput").value.trim();if(!e&&!b)return;const t=new Date,n=`${t.getFullYear()}. ${t.getMonth()+1}. ${t.getDate()}.`,a=t.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"});f.push({id:Date.now(),text:e,img:b,tags:[document.getElementById("folderSelect").value],date:n,time:a,fav:!1});const o=document.getElementById("saveBtn");o&&(o.classList.add("saving"),setTimeout(()=>o.classList.remove("saving"),180),o.classList.add("saved"),setTimeout(()=>o.classList.remove("saved"),220),le(o,11)),document.getElementById("memoInput").value="",j(!0),u={start:n,end:n},E="idle",w=null,d("ì €ì¥ëì–´ìš” âœ´ï¸"),C()}function Q(){const e=document.getElementById("calGridContainer");e.innerHTML="";const t=document.createElement("div");t.className="cal-grid";const n=R.getFullYear(),a=R.getMonth();document.getElementById("calMonth").innerText=`${n}ë…„ ${a+1}ì›”`,["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "].forEach((l,m)=>{const c=document.createElement("div");c.className="cal-dow"+(m===0?" sun":m===6?" sat":""),c.innerText=l,t.appendChild(c)});const o=new Date(n,a,1).getDay(),i=new Date(n,a+1,0).getDate();for(let l=0;l<o;l++)t.appendChild(document.createElement("div"));const s=u?F(u.start,u.end):null;function r(l){var c;return((c=l==null?void 0:l.dataset)==null?void 0:c.dateStr)||null}function y(l){if(!u){u={start:l,end:l},E="awaitEnd",w=l,d("ì‹œì‘ì¼ ì„ íƒë¨","ë‹¤ë¥¸ ë‹¬ë¡œ ì´ë™í•´ì„œ ì¢…ë£Œì¼ì„ ì„ íƒí•´ìš”"),p();return}if(E==="awaitEnd"&&w){u=F(w,l),E="idle",w=null,d("ë²”ìœ„ ì„ íƒ ì™„ë£Œ"),p();return}u={start:l,end:l},E="awaitEnd",w=l,d("ì‹œì‘ì¼ ì„ íƒë¨","ì¢…ë£Œì¼ì„ ì„ íƒí•´ìš” (ë‹¤ë¥¸ ë‹¬ ê°€ëŠ¥)"),p()}for(let l=1;l<=i;l++){const m=`${n}. ${a+1}. ${l}.`,c=document.createElement("div");c.className="cal-day",c.innerText=l,c.dataset.dateStr=m;const B=new Date(n,a,l).getDay();B===0&&c.classList.add("sun"),B===6&&c.classList.add("sat"),f.some(h=>h.date===m)&&c.classList.add("has-memo"),s&&(G(m,s)&&c.classList.add("in-range"),m===s.start&&c.classList.add("range-start"),m===s.end&&c.classList.add("range-end")),c.addEventListener("pointerdown",h=>{if(h.preventDefault(),c.setPointerCapture(h.pointerId),D=!0,E!=="awaitEnd"){u={start:m,end:m},E="awaitEnd",w=m,p(),d("ì‹œì‘ì¼ ì„ íƒë¨","ë“œë˜ê·¸ë¡œ ì¡°ì ˆí•˜ê±°ë‚˜, ë‹¤ë¥¸ ë‹¬ë¡œ ì´ë™í•´ ì¢…ë£Œì¼ì„ íƒ­í•´ìš”");return}}),c.addEventListener("pointermove",h=>{var H;if(!D||E!=="awaitEnd"||!w)return;const k=document.elementFromPoint(h.clientX,h.clientY),_=r((H=k==null?void 0:k.closest)==null?void 0:H.call(k,".cal-day"));_&&(u=F(w,_),p())}),c.addEventListener("pointerup",h=>{h.preventDefault(),D=!1}),c.addEventListener("pointercancel",()=>{D=!1}),c.addEventListener("click",()=>{D||y(m)}),t.appendChild(c)}e.appendChild(t)}function De(e){R.setMonth(R.getMonth()+e),Q()}function Z(){u=null,E="idle",w=null,d("ì „ì²´ë³´ê¸°"),p()}function Pe(e){if(!e){Z();return}u={start:e,end:e},E="idle",w=null,p()}function Fe(e){q=e,document.getElementById("tabAll").classList.toggle("active",!e),document.getElementById("tabFav").classList.toggle("active",e),p()}function _e(){const e=document.getElementById("rangeTextWrap");if(!e)return;if(!u){e.style.display="none",e.innerHTML="";return}const t=F(u.start,u.end);if(!t){e.style.display="none",e.innerHTML="";return}e.style.display="block",e.innerHTML=`
        <div class="range-line">
          ${E==="awaitEnd"?"ì¢…ë£Œì¼ ì„ íƒ ì¤‘ Â· ":""}${Y(t.start)} ~ ${Y(t.end)}
          <button class="range-chip-btn" onclick="clearRangeSelection()" title="ë²”ìœ„ í•´ì œ">âœ•</button>
        </div>
      `}function p(){document.getElementById("lockBtn").innerText=I?"ğŸ”’":"ğŸ”“",Q(),_e(),W();const e=(document.getElementById("searchInput").value||"").toLowerCase(),t=u?F(u.start,u.end):null,n=t?f.filter(r=>G(r.date,t)):f;document.getElementById("allCount").innerText=n.length,document.getElementById("favCount").innerText=n.filter(r=>r.fav).length,document.getElementById("sparkDayCount").innerText=[...new Set(f.map(r=>r.date))].length;const a=document.getElementById("folderList"),o=document.getElementById("folderSelect");a.innerHTML='<div class="folder-chip" onclick="toggleSearch()">ğŸ”</div>',a.innerHTML+=`<div class="folder-chip ${L==="ì „ì²´"?"active":""}" onclick="changeFolder('ì „ì²´')">ì „ì²´</div>`,o.innerHTML="",v.forEach(r=>{a.innerHTML+=`<div class="folder-chip ${L===r?"active":""}" onclick="changeFolder('${r}')">${r} <span class="btn-del-folder" onclick="deleteFolder('${r}', event)">Ã—</span></div>`,o.innerHTML+=`<option value="${r}" ${L===r?"selected":""}>${r}</option>`}),a.innerHTML+='<div class="folder-chip" onclick="addFolder()">+</div>';const i=document.getElementById("memoContainer");i.innerHTML="",n.filter(r=>(L==="ì „ì²´"||r.tags.includes(L))&&(!q||r.fav)&&(r.text||"").toLowerCase().includes(e)).reverse().forEach(r=>{const y=!!I&&!x.includes(r.id),l=document.createElement("div");l.className="memo-item",l.dataset.id=r.id,l.innerHTML=`
          ${y?`<div class="lock-overlay" onclick="unlockTemporarily(${r.id})"><span>ğŸ”’ ì ê¸´ ì˜ê° (íƒ­í•˜ì—¬ ì¼ì‹œí•´ì œ)</span></div>`:""}
          <div class="${y?"locked-content":""}">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <select class="memo-folder-select" onchange="updateMemoTag(${r.id}, this.value)">
                ${v.map(m=>`<option value="${m}" ${r.tags[0]===m?"selected":""}>${m}</option>`).join("")}
              </select>

              <span class="star-btn"
                    onpointerdown="event.stopPropagation()"
                    onclick="toggleFav(${r.id}, this); event.stopPropagation();">
                ${r.fav?"â­":"â˜†"}
              </span>
            </div>

            ${r.img?`<img src="${r.img}" style="width:100%; border-radius:15px; margin-top:15px; border:1px solid var(--border);"
                        onclick="openImageViewer('${r.img}')" />`:""}

            <div style="font-size:17px; line-height:1.8; margin-top:15px; font-weight:850;">
              ${(r.text||"").replace(/\n/g,"<br>")}
            </div>

            <div style="margin-top:15px; display:flex; justify-content:space-between; font-size:12px; color:var(--sub-text); border-top:1px solid var(--border); padding-top:15px; font-weight:850;">
              <span>${r.date} ${r.time}</span>
              <span onclick="confirmDeleteMemo(${r.id})"
                    style="color:#ff5f5f;cursor:pointer;font-weight:950;-webkit-tap-highlight-color: transparent;">
                ì‚­ì œ
              </span>
            </div>
          </div>
        `,i.appendChild(l)})}async function He(e=!1){const n=!document.body.classList.contains("dark-mode");document.body.classList.toggle("dark-mode",n),document.getElementById("themeBtn").innerText=n?"â˜€ï¸":"ğŸŒ™",document.getElementById("mainLogo").src=n?"logo_d.png":"logo_l.png",e&&localStorage.setItem("inspy_theme",n?"dark":"light"),d(n?"ë‹¤í¬ ëª¨ë“œ":"ë¼ì´íŠ¸ ëª¨ë“œ")}te();oe();p();j(!0);Object.assign(window,{addFolder:Ee,addMemo:Ce,changeFolder:Te,changeMonth:De,clearAttachedImage:j,clearRangeSelection:Z,clearSearch:we,closeImageViewer:se,closeModal:g,confirmDeleteMemo:ke,deleteFolder:be,exportData:ce,filterDate:Pe,handleLockToggle:ge,handleSearchInput:Ie,importData:de,modalOnBackdrop:me,openImageViewer:J,openPalette:ue,previewImage:Me,setFavFilter:Fe,setPrimary:N,toggleFav:xe,toggleSearch:ve,toggleTheme:He,unlockTemporarily:he,updateMemoTag:Be});
